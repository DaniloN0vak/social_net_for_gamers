{"ast":null,"code":"import { sendMessage, getChat } from \"../api/chatApi\";\nasync function gifToFile(src) {\n  try {\n    const response = await fetch(src);\n    const blob = await response.blob();\n    return new File([blob], 'gif.gif', {\n      type: blob.type\n    });\n  } catch (err) {\n    console.error('Ошибка при загрузке gif:', err);\n    return null;\n  }\n}\nexport async function send(chatId, userId, content = \"\", media = [], audio = null, gifUrl = \"\") {\n  const formData = new FormData();\n  formData.append(\"content\", content);\n  formData.append(\"userId\", userId);\n  media.forEach((item, index) => {\n    formData.append(`media[${index}].file`, item.file);\n    formData.append(`media[${index}].isBloored`, item.isBloored);\n    formData.append(`media[${index}].name`, item.name);\n    formData.append(`media[${index}].type`, item.type);\n    formData.append(`media[${index}].size`, item.size);\n  });\n  if (audio) {\n    const index = media.length;\n    formData.append(`media[${index}].file`, audio.file);\n    formData.append(`media[${index}].isBloored`, false);\n    formData.append(`media[${index}].name`, audio.name);\n    formData.append(`media[${index}].type`, audio.type);\n  }\n  if (gifUrl) {\n    const gifFile = await gifToFile(gifUrl);\n    if (gifFile) {\n      const index = media.length + (audio ? 1 : 0);\n      console.log(index);\n      formData.append(`media[${index}].file`, gifFile);\n      formData.append(`media[${index}].isBloored`, false);\n      formData.append(`media[${index}].name`, gifFile.name);\n      formData.append(`media[${index}].type`, gifFile.type);\n    }\n  }\n  try {\n    const response = await sendMessage(chatId, formData);\n    return response.data;\n  } catch (error) {\n    console.error(\"Ошибка при отправке сообщения:\", error);\n    throw error;\n  }\n}\nexport async function getChatById(chatId) {\n  try {\n    const response = await getChat(chatId);\n    return response.data;\n  } catch (error) {\n    console.error(\"Ошибка при получении:\", error);\n    throw error;\n  }\n}","map":{"version":3,"names":["sendMessage","getChat","gifToFile","src","response","fetch","blob","File","type","err","console","error","send","chatId","userId","content","media","audio","gifUrl","formData","FormData","append","forEach","item","index","file","isBloored","name","size","length","gifFile","log","data","getChatById"],"sources":["D:/Diplomarbeit/Project/Frontend/frontend/src/hooks/apiService.js"],"sourcesContent":["import { sendMessage, getChat } from \"../api/chatApi\";\r\n\r\nasync function gifToFile(src) {\r\n  try {\r\n    const response = await fetch(src);\r\n    const blob = await response.blob();\r\n    return new File([blob], 'gif.gif', { type: blob.type });\r\n  } catch (err) {\r\n    console.error('Ошибка при загрузке gif:', err);\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function send(chatId, userId, content = \"\", media = [], audio = null, gifUrl = \"\") {\r\n  const formData = new FormData();\r\n  formData.append(\"content\", content);\r\n  formData.append(\"userId\", userId);\r\n\r\n  media.forEach((item, index) => {\r\n    formData.append(`media[${index}].file`, item.file);\r\n    formData.append(`media[${index}].isBloored`, item.isBloored);\r\n    formData.append(`media[${index}].name`, item.name);\r\n    formData.append(`media[${index}].type`, item.type);\r\n    formData.append(`media[${index}].size`, item.size);\r\n  });\r\n\r\n  if (audio) {\r\n    const index = media.length;\r\n    formData.append(`media[${index}].file`, audio.file);\r\n    formData.append(`media[${index}].isBloored`, false);\r\n    formData.append(`media[${index}].name`, audio.name);\r\n    formData.append(`media[${index}].type`, audio.type);\r\n  }\r\n\r\n\r\n\r\n  if (gifUrl) {\r\n    const gifFile = await gifToFile(gifUrl);\r\n    if (gifFile) {\r\n      const index = media.length + (audio ? 1 : 0);\r\n      console.log(index);\r\n      formData.append(`media[${index}].file`, gifFile);\r\n      formData.append(`media[${index}].isBloored`, false);\r\n      formData.append(`media[${index}].name`, gifFile.name);\r\n      formData.append(`media[${index}].type`, gifFile.type);\r\n    }\r\n  }\r\n\r\n\r\n\r\n  try {\r\n    const response = await sendMessage(chatId, formData);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Ошибка при отправке сообщения:\", error);\r\n    throw error;\r\n  }\r\n}\r\n\r\nexport async function getChatById(chatId) {\r\n  try {\r\n    const response = await getChat(chatId);\r\n    return response.data;\r\n  }\r\n  catch (error) {\r\n    console.error(\"Ошибка при получении:\", error);\r\n    throw error;\r\n  }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}