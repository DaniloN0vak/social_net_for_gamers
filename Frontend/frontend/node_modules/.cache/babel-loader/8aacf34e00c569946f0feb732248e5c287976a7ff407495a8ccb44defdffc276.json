{"ast":null,"code":"var _jsxFileName = \"D:\\\\Diplomarbeit\\\\Project\\\\Frontend\\\\frontend\\\\src\\\\blocks\\\\message-items\\\\message-list\\\\components\\\\MessageGroupList.js\",\n  _s = $RefreshSig$();\nimport React, { useMemo, useRef, useEffect } from 'react';\nimport { Virtuoso, VirtuosoHandle } from 'react-virtuoso';\nimport MessageGroup from '../../message-group/components/MessageGroup';\nimport DataSeparator from '../../../shared/data-separator/DataSeparator';\nimport { formatDateForSeparator, checkNewDay } from '../../../../utils/dateUtils';\nimport styles from '../styles/MessageGroupList.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst separatorStyles = {\n  styleContainer: {\n    width: '100%',\n    marginTop: '20px',\n    marginBottom: '40px',\n    color: '#2C2F36',\n    padding: '0 12.37%'\n  },\n  styleText: {\n    margin: '0 12px',\n    fontSize: '16px',\n    fontFamily: '\"Raleway\" sans-serif',\n    lineHeight: '25px',\n    letterSpacing: '0',\n    color: '#ADADBD',\n    fontWeight: '400'\n  },\n  lineColor: '#2C2F36'\n};\nfunction MessageGroupList({\n  messages,\n  currentUserId\n}) {\n  _s();\n  const virtuosoRef = useRef(null); // тип: VirtuosoHandle | null\n\n  const renderedItems = useMemo(() => {\n    const result = [];\n    let group = [];\n    let lastUser = null;\n    let lastDate = null;\n    messages.forEach(msg => {\n      const sentDate = msg.sentAt instanceof Date ? msg.sentAt : new Date(msg.sentAt);\n      const isNewUser = msg.user.id !== lastUser;\n      const isNewDay = !lastDate || checkNewDay(lastDate, sentDate);\n      if (group.length && (isNewUser || isNewDay)) {\n        result.push({\n          type: 'group',\n          messages: group,\n          isLeft: group[0].user.id !== currentUserId\n        });\n        group = [];\n      }\n      if (isNewDay) {\n        result.push({\n          type: 'date',\n          date: sentDate\n        });\n      }\n      group.push(msg);\n      lastUser = msg.user.id;\n      lastDate = sentDate;\n    });\n    if (group.length) {\n      result.push({\n        type: 'group',\n        messages: group,\n        isLeft: group[0].user.id !== currentUserId\n      });\n    }\n    return result;\n  }, [messages, currentUserId]);\n\n  // Скролл к самому низу при добавлении сообщений\n  useEffect(() => {\n    if (virtuosoRef.current && renderedItems.length > 0) {\n      virtuosoRef.current.scrollToIndex({\n        index: renderedItems.length - 1,\n        behavior: 'smooth'\n      });\n    }\n  }, [renderedItems]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: styles.container,\n    children: /*#__PURE__*/_jsxDEV(Virtuoso, {\n      ref: virtuosoRef,\n      data: renderedItems,\n      className: styles.myScrollContainer,\n      style: {\n        height: '100%'\n      },\n      itemContent: (index, item) => {\n        if (item.type === 'group') {\n          return /*#__PURE__*/_jsxDEV(MessageGroup, {\n            messages: item.messages,\n            isLeft: item.isLeft\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 29\n          }, this);\n        }\n        if (item.type === 'date') {\n          return /*#__PURE__*/_jsxDEV(DataSeparator, {\n            data: item.date ? formatDateForSeparator(item.date) : 'Невідомо',\n            separatorStyles: separatorStyles\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 29\n          }, this);\n        }\n        return null;\n      },\n      followOutput: \"allways\",\n      initialTopMostItemIndex: renderedItems.length\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n}\n_s(MessageGroupList, \"n1cDyxfqPJ8g8tJ1mOT4GLxGVKQ=\");\n_c = MessageGroupList;\nexport default _c2 = /*#__PURE__*/React.memo(MessageGroupList);\nvar _c, _c2;\n$RefreshReg$(_c, \"MessageGroupList\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"names":["React","useMemo","useRef","useEffect","Virtuoso","VirtuosoHandle","MessageGroup","DataSeparator","formatDateForSeparator","checkNewDay","styles","jsxDEV","_jsxDEV","separatorStyles","styleContainer","width","marginTop","marginBottom","color","padding","styleText","margin","fontSize","fontFamily","lineHeight","letterSpacing","fontWeight","lineColor","MessageGroupList","messages","currentUserId","_s","virtuosoRef","renderedItems","result","group","lastUser","lastDate","forEach","msg","sentDate","sentAt","Date","isNewUser","user","id","isNewDay","length","push","type","isLeft","date","current","scrollToIndex","index","behavior","className","container","children","ref","data","myScrollContainer","style","height","itemContent","item","fileName","_jsxFileName","lineNumber","columnNumber","followOutput","initialTopMostItemIndex","_c","_c2","memo","$RefreshReg$"],"sources":["D:/Diplomarbeit/Project/Frontend/frontend/src/blocks/message-items/message-list/components/MessageGroupList.js"],"sourcesContent":["import React, { useMemo, useRef, useEffect } from 'react';\r\nimport { Virtuoso, VirtuosoHandle } from 'react-virtuoso';\r\nimport MessageGroup from '../../message-group/components/MessageGroup';\r\nimport DataSeparator from '../../../shared/data-separator/DataSeparator';\r\nimport { formatDateForSeparator, checkNewDay } from '../../../../utils/dateUtils';\r\nimport styles from '../styles/MessageGroupList.module.css';\r\n\r\nconst separatorStyles = {\r\n    styleContainer: {\r\n        width: '100%',\r\n        marginTop: '20px',\r\n        marginBottom: '40px',\r\n        color: '#2C2F36',\r\n        padding: '0 12.37%',\r\n    },\r\n    styleText: {\r\n        margin: '0 12px',\r\n        fontSize: '16px',\r\n        fontFamily: '\"Raleway\" sans-serif',\r\n        lineHeight: '25px',\r\n        letterSpacing: '0',\r\n        color: '#ADADBD',\r\n        fontWeight: '400',\r\n    },\r\n    lineColor: '#2C2F36',\r\n};\r\n\r\nfunction MessageGroupList({ messages, currentUserId }) {\r\n    const virtuosoRef = useRef(null); // тип: VirtuosoHandle | null\r\n\r\n    const renderedItems = useMemo(() => {\r\n        const result = [];\r\n        let group = [];\r\n        let lastUser = null;\r\n        let lastDate = null;\r\n\r\n        messages.forEach((msg) => {\r\n            const sentDate = msg.sentAt instanceof Date ? msg.sentAt : new Date(msg.sentAt);\r\n            const isNewUser = msg.user.id !== lastUser;\r\n            const isNewDay = !lastDate || checkNewDay(lastDate, sentDate);\r\n\r\n            if (group.length && (isNewUser || isNewDay)) {\r\n                result.push({ type: 'group', messages: group, isLeft: group[0].user.id !== currentUserId });\r\n                group = [];\r\n            }\r\n\r\n            if (isNewDay) {\r\n                result.push({ type: 'date', date: sentDate });\r\n            }\r\n\r\n            group.push(msg);\r\n            lastUser = msg.user.id;\r\n            lastDate = sentDate;\r\n        });\r\n\r\n        if (group.length) {\r\n            result.push({ type: 'group', messages: group, isLeft: group[0].user.id !== currentUserId });\r\n        }\r\n\r\n        return result;\r\n    }, [messages, currentUserId]);\r\n\r\n    // Скролл к самому низу при добавлении сообщений\r\n    useEffect(() => {\r\n        if (virtuosoRef.current && renderedItems.length > 0) {\r\n            virtuosoRef.current.scrollToIndex({\r\n                index: renderedItems.length - 1,\r\n                behavior: 'smooth',\r\n            });\r\n        }\r\n    }, [renderedItems]);\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <Virtuoso\r\n                ref={virtuosoRef}\r\n                data={renderedItems}\r\n                className={styles.myScrollContainer}\r\n                style={{ height: '100%' }}\r\n                itemContent={(index, item) => {\r\n                    if (item.type === 'group') {\r\n                        return (\r\n                            <MessageGroup\r\n                                messages={item.messages}\r\n                                isLeft={item.isLeft}\r\n                            />\r\n                        );\r\n                    }\r\n\r\n                    if (item.type === 'date') {\r\n                        return (\r\n                            <DataSeparator\r\n                                data={item.date ? formatDateForSeparator(item.date) : 'Невідомо'}\r\n                                separatorStyles={separatorStyles}\r\n                            />\r\n                        );\r\n                    }\r\n\r\n                    return null;\r\n                }}\r\n                followOutput=\"allways\"\r\n                initialTopMostItemIndex={renderedItems.length}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default React.memo(MessageGroupList);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}